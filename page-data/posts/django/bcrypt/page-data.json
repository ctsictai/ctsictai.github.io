{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/django/bcrypt","result":{"data":{"markdownRemark":{"id":"348cb644-b32c-58a5-b814-72d539bfc1ff","html":"<h1 id=\"bcrypt란\"><a href=\"#bcrypt%EB%9E%80\" aria-label=\"bcrypt란 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bcrypt란?</h1>\n<p>Blowfish를 기반으로 만들어진 “단방향 암호화 해싱함수”로 1999년 USENIX에서 발표됐다. Rainbow table 공격을 막기 위해서 salt를 사용하며, 암호검사 요청이 반복될 수록 cost를 늘림으로써, 무차별 대입 공격(brute-force search)을 막을 수 있다. cost는 반복횟수로 2^n 이다.</p>\n<ul>\n<li>Rainbow table attack이란?\n미리 해쉬값들을 계산해 놓은 테이블을 Rainbow table이라고 한다. 이것으로 암호화된 해쉬값을 풀어내는 것</li>\n</ul>\n<h2 id=\"bcrypt-암호화-적용-구조\"><a href=\"#bcrypt-%EC%95%94%ED%98%B8%ED%99%94-%EC%A0%81%EC%9A%A9-%EA%B5%AC%EC%A1%B0\" aria-label=\"bcrypt 암호화 적용 구조 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bcrypt 암호화 적용 구조</h2>\n<p><img src=\"https://docs.google.com/drawings/d/e/2PACX-1vQNx1HRk87QQFoenXuRby493jI2Eg6gXIlTN-sxLFfurB-5FI5I5lutbrO-OPqWdnln2PBWXJv2X2Kl/pub?w=860&#x26;h=168\"></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>:</mo><mi>b</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mtext>의오리지날버전은</mtext></mrow><annotation encoding=\"application/x-tex\">: bcrypt의 오리지날 버전은</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">c</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">t</span><span class=\"mord hangul_fallback\">의</span><span class=\"mord hangul_fallback\">오</span><span class=\"mord hangul_fallback\">리</span><span class=\"mord hangul_fallback\">지</span><span class=\"mord hangul_fallback\">날</span><span class=\"mord hangul_fallback\">버</span><span class=\"mord hangul_fallback\">전</span><span class=\"mord hangul_fallback\">은</span></span></span></span>2a<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>:</mo><mi>b</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mtext>의오리지날버전은</mtext></mrow><annotation encoding=\"application/x-tex\">: bcrypt의 오리지날 버전은</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">c</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">t</span><span class=\"mord hangul_fallback\">의</span><span class=\"mord hangul_fallback\">오</span><span class=\"mord hangul_fallback\">리</span><span class=\"mord hangul_fallback\">지</span><span class=\"mord hangul_fallback\">날</span><span class=\"mord hangul_fallback\">버</span><span class=\"mord hangul_fallback\">전</span><span class=\"mord hangul_fallback\">은</span></span></span></span>2<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>다</mtext><mi mathvariant=\"normal\">.</mi><mtext>오리지날버전은</mtext><mi>n</mi><mi>o</mi><mi>n</mi><mo>−</mo><mi>A</mi><mi>S</mi><mi>C</mi><mi>I</mi><mi>I</mi><mtext>문자나</mtext><mi>N</mi><mi>u</mi><mi>l</mi><mi>l</mi><mtext>문자를처리하는방법을정의하지않았다</mtext><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">다. 오리지날 버전은 non-ASCII 문자나 Null 문자를 처리하는 방법을 정의하지 않았다.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord hangul_fallback\">다</span><span class=\"mord\">.</span><span class=\"mord hangul_fallback\">오</span><span class=\"mord hangul_fallback\">리</span><span class=\"mord hangul_fallback\">지</span><span class=\"mord hangul_fallback\">날</span><span class=\"mord hangul_fallback\">버</span><span class=\"mord hangul_fallback\">전</span><span class=\"mord hangul_fallback\">은</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathdefault\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathdefault\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord hangul_fallback\">문</span><span class=\"mord hangul_fallback\">자</span><span class=\"mord hangul_fallback\">나</span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathdefault\">u</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord hangul_fallback\">문</span><span class=\"mord hangul_fallback\">자</span><span class=\"mord hangul_fallback\">를</span><span class=\"mord hangul_fallback\">처</span><span class=\"mord hangul_fallback\">리</span><span class=\"mord hangul_fallback\">하</span><span class=\"mord hangul_fallback\">는</span><span class=\"mord hangul_fallback\">방</span><span class=\"mord hangul_fallback\">법</span><span class=\"mord hangul_fallback\">을</span><span class=\"mord hangul_fallback\">정</span><span class=\"mord hangul_fallback\">의</span><span class=\"mord hangul_fallback\">하</span><span class=\"mord hangul_fallback\">지</span><span class=\"mord hangul_fallback\">않</span><span class=\"mord hangul_fallback\">았</span><span class=\"mord hangul_fallback\">다</span><span class=\"mord\">.</span></span></span></span>2a$는 널 문자를 포함하며, UTF-8로 인코딩 할 것을 정의한 버전이다. (encoding=‘utf-8’)</li>\n<li>10$ : Cost의 크기는 2^10이다. Iteration count를 1024만큼 돌리겠다는 얘기다. (bcrypt.gensalt(round=10))</li>\n<li>N9qo8uLOickgx2ZMRZoMye : 랜덤하게 만든 salt</li>\n<li>ljZAgcFl7p92ldGxad68LJZdL17lhWy : 패스워드. Salt와 패스워드를 묶어서 해시해버렸기 때문에, 유추가 불가능하다.</li>\n</ul>\n<p><img src=\"http://d2.naver.com/content/images/2015/06/helloworld-318732-2.png\"></p>\n<h1 id=\"django에서-사용하기\"><a href=\"#django%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"django에서 사용하기 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Django에서 사용하기</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import bcrypt # 임포트한다(그 전에 라이브러리 설치는 필수)</code></pre></div>\n<h2 id=\"main-processsignup\"><a href=\"#main-processsignup\" aria-label=\"main processsignup permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Main process(signup)</h2>\n<p>bytes(user_data, encoding=‘utf-8’) → bcrypt.hashpw(data, bcrypt.gensalt()) -> .decode(‘utf-8’)</p>\n<ul>\n<li>bytes(암호화할 패스워드, encoding=‘utf-8’한글포함한 대부분의 문자 포함)화 한다</li>\n<li>bcrypt.hashpw(암호화할 패스워드, 솔트 추가) - 암호화 함수</li>\n<li>bcrypt.gensalt() -보안강화를 위한 salt 추가!</li>\n<li>.decode(‘utf-8’) - type을 ‘str’으로 변환</li>\n</ul>\n<h1 id=\"signin-process\"><a href=\"#signin-process\" aria-label=\"signin process permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Signin Process</h1>\n<p>password 값 도착 → bcrypt.hashpw(받은password, bcrypt.gensalt()) → DB password encoding→ checkpw(받은 패스워드 인코딩한 값, DB에 저장된 password 인코딩한 값) 비교</p>\n<ul>\n<li>프론트에서 입력한 password를 요청 받음</li>\n<li>받은 password 암호화</li>\n<li>DB password 불러와서 encoding한다. (type 맞춰주기 위해서)</li>\n<li>bcrypt.checkpw(받은 패스워드 인코딩한 값, DB에 저장된 password 인코딩한 값) 비교 함수 적용</li>\n<li>일치하면 로그인 성공</li>\n<li>일치하지 않으면 로그인 실패</li>\n</ul>\n<h2 id=\"추가로-쓰이는-인자\"><a href=\"#%EC%B6%94%EA%B0%80%EB%A1%9C-%EC%93%B0%EC%9D%B4%EB%8A%94-%EC%9D%B8%EC%9E%90\" aria-label=\"추가로 쓰이는 인자 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추가로 쓰이는 인자</h2>\n<ul>\n<li>bcrypt.gensalt(round=4) : round는 cost 인자로서 해쉬 함수를 반복할 횟수를 결정한다. 이 때 반복 횟수는 2^n이 된다.</li>\n</ul>\n<h2 id=\"예시\"><a href=\"#%EC%98%88%EC%8B%9C\" aria-label=\"예시 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예시</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># bcrypt 임포트한다\nimport bcrypt\npassword = b&quot;super secret password&quot;\n# 패스워드 해싱\nhashed = bcrypt.hashpw(password, bcrypt.gensalt(14))\n# DB 저장 패스워드 가져오기\nuser_data      = User.objects.get(email=data[&quot;email&quot;])\nuser_password  = user_data.password.encode(&#39;utf-8&#39;)\n# 프론트에서 받은 패스워드 hashing\nbyted_password = bcrypt.hashpw(data[&#39;password&#39;], bcrypt.gensalt(14))\n# 패스워드 체크\nif bcrypt.checkpw(byted_password, user_password):\n    print(&quot;It Matches!&quot;)\nelse:\n    print(&quot;It Does not Match :(&quot;)</code></pre></div>","fields":{"slug":"/posts/django/bcrypt","tagSlugs":["/tag/django-bcrypt/"]},"frontmatter":{"date":"2020-01-13T23:30:03.284Z","description":"Bcrypt encryption of security information","tags":["Django, Bcrypt"],"title":"Bcrypt","socialImage":"/media/gutenberg.jpg"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/django/bcrypt"}}}