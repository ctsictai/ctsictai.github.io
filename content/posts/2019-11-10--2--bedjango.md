---
title: Django Apprenticeship Study Part.4
date: "2019-11-10T23:30:03.284Z"
template: "post"
draft: false
slug: "/posts/django-part4/"
category: "Python/Django"
tags:
  - "Python/Django"

description: "Django tutorial models.py"
socialImage: "/media/gutenberg.jpg"
---

## previously

- django modeling & data base

  ## 커스텀 앱 디텍토리 생성

  ☞ python manage.py startapp books ☜ 치면 앱 만들 수 있음

  - 단, 해당 프로젝트 디렉토리 안에서 명령어를 쳐야 정상적으로 만들어 진다

  # 모델의 구성

  각 Field(=column) 인스턴스의 이름이 데이터베이스의 형식에 맞는 데이터베이스 필드의 이름이 된다.(컬럼명) 이 이름을  쿼리 및 탬플릿에서 이를 참조하는 데 쓰인다. 데이터베이스는 컬럼 이름으로 사용하게 됩니다 밑에서 my_field_name은 내가 정한 임의의 네임이다.

  `My_field_name = model.CharField(max_length=20, help_text='Enter field documentation')`

# 지원하는 모델 필드 타입

- Field type : AutoField, BooleanField, CharField, DateTimeField, FileField, IntegerField, ImageField,TextField

- Relation ship Types : ForeignKey, ManyToManyField, OneToOneField

# field optional argument

- help_text: 위에서 다뤘던 것 처럼, HTML 양식(form)에 대해 텍스트 라벨을 제공합니다 (예시 : 관리자 사이트).

- verbose_name: 필드 라벨 안에서 사용되는 인간이 읽을 수 있는 필드 이름입니다. 지정되지 않았다면, 장고가 기본 verbose_name을 필드 이름으로부터 유추합니다.

- default: 필드를 위한 기본값입니다. 이것은 값 또는 호출 가능한 객체일 수 있습니다. 이때 객체는 새로운 레코드가 생성될 때 마다 호출됩니다.

- null: 만약 True라면, 장고는 빈 NULL 값을 필드를 위한 데이터베이스에 저장할 것입니다( CharField 는 대신 빈 문자열을 저장할 것입니다). 기본값은 False입니다.

- blank: 만약 True라면, 필드는 양식(form) 안에서 비워두는 것이 허락됩니다. 기본값은 False이며, 이것은 장고의 양식(form) 검증이 값을 입력하도록 강제한다는 뜻입니다. 이것은 종종  null=True 와 함께 사용됩니다. blank 값을 허락할 때, 데이터베이스에서도 공백값을 적절하게 표시할 수 있어야 하기 때문입니다.

- choices: 필드를 위한 선택들의 모임입니다. 이 인수가 제공된다면, 대응하는 기본 양식(form) 위젯은 표준 텍스트 필드가 아닌 이 선택 항목을 가진 선택 상자입니다.

- primary_key: 만약 True라면, 현재 필드를 모델의 primary key로 설정합니다(primary key는 모든 다른 테이블 레코드들을 고유하게 확인하도록 지정된 특별한 데이터베이스 열입니다). primary key로 지정된 필드가 없다면 장고가 자동적으로 이 목적의 필드를 추가합니다.

- unique : True 인 경우이 필드는 테이블 전체에서 고유해야합니다.

# 모델 관리

모델 클래스들을 정의한 이후엔 클래스들을 사용해서 레코드들을 생성, 업데이트, 또는 삭제할 수 있고, 모든 레코드 또는 레코드의 특정 하위 집합을 가져오기 위해 쿼리를 실행할 수 있습니다. 튜토리얼에서 뷰를 정의할 때 그 방법을 보여줄 것이지만, 아래에 간략한 요약이 있습니다.

## 레코드의 생성과 수정

레코드를 생성하려먼 모델의 인스턴스를 정의하고 save()를 호출할 수 있습니다.

- Create a new record using the model's constructor.  
  `record = MyModelName(my_field_name="Instance #1")`

- Save the object into the database.  
  `record.save()`

- Note: 만약 당신이 어떤 필드도 primary_key를 선언하지 않았다면, 새로운 레코드는 자동적으로 id라는 필드 이름을 가진 primary_key 가 주어지게 됩니다. 위의 레코드를 저장한 후 이 id 필드를 쿼리할 수 있는데, 1의 값을 가질 겁니다

* Change record by modifying the fields, then calling save().

```
record.my_field_name = 'New Instance Name'
record.save()
```

# Field Types

## AutoField

ID로 사용 가능한 자동으로 증가하는 IntegerField - 보통은 직접 사용할 필요가 없고 장고에서 기본키로 별도로지정하지 않는 다면 다종으로 추가된다.

## BigAutoField

64비트 정수값을 가지는 AutoField이다.

## CharField

문자열 data를 저장할 수 있는 문자열 필드이다. option중 **max_length=**를 지정하여 문자열의 길이를 제한할 수 있다.

- max_length를 통해 유효성 검증 로직을 구현할 수 있다

게시판의 긴 글을 저장할 때는 TextField를 사용한다.

## TextField

큰 텍스트 필드로서 CharField가 저장하기엔 긴 텍스트 data인 경우에 사용한다. 주로 post의 글을 저장할 때 사용한다.

## DateField

python에서 제공하는 날짜를 표현하는 datetime.date 인스턴스에 의해 표현되는 날짜다.

필수적으로 지정해야하는 option에

- auto_now : 객체가 저장될 때마다 매번 자동으로 필드를 현재시간이 설정한다. last-modified 타임스탬프로서 유용하다.  
  model.save()일 때 수정되고 model.update() 때는 반응하지 않는다.

- auto_now_add : 객체가 처음 생성 될 때 자동으로 현재시간이 설정된다. 생성의 타임스탬프로 유용함.  
  기본값을 재정의가 불가능하다.
  이 필드의 수정이 필요하다면 auto_now_add=True 대신에 - default = today (datetime.date.today()) - default = timezone.now (django.utils.timezone.now())

## DateTimeField

위의 DateField에서 datetime.datetime 인스턴스로 표햔되는 날짜와 시간. DateField와 동일한 추가 인수를 가지고 있음

## DecimalField

고정소수로 decimal 인스턴스로 나타난다. 두 개의 필수 option

- max_digits : 숫자에 허용되는 최대 자리수. 이 숫자는 decimal_places보다 크거나 같아야 한다.
- decimal_places : 숫자와 함께 저장될 소수 자릿 수.

**이 필드의 기본 폼은 localize 설정이 false면 NumberInput True면 TextInput이다.**

## FileField

파일 업로드 필드
primary_key 인수를 지원하지 않고 사용하면 에러 발생

- upload_to : 업로드 디렉터리와 파일 이름을 설정하는 방법을 제공하고 두 가지 방법을 사용할 수 있다.
  문자열 값을 지정하면 strftime() 형식을 포함 할 수 있다. 주어진 디렉터리에 포맷 형식을 업로드 일시로 변경 후 파일이 업로드 된다.

## IntegerField

정수 입력 필드. ddjango가 지원하는 모든 데이터베이스에서 -217483648 ~ 214783647 사이의 값은 저장 가능하다

## BigIntegerField

정수 입력 필드이나 IntegerField에서 입력하지 못한 그 밖의 큰 수를 입력해야 할 때 쓰는 필드이다.

## URLField

URL을 위한 CharField이다. default max_length = 200이다.

## UUIDField

Universally Unique Identifiers를 저장하기 위한 필드이다. python UUID클래스를 사용한다.  
 UUID는 기본키(PK)를 위한 AutoField를 대신하는 좋은 방법이다. 데이터베이스는 UUID를 생성하지 않으므로 기본값 사용을 추천한다.

## ForeignKey

1:N 관계를 정의하는 필드로 참조하려는 주체의 필드에 지정한다.  
데이터베이스 인덱스는 자동으로 생성된다. db_index를 false로 설정하여 비활성화시킬 수 있다. 조인보다 일관성을 위한 외래키를 만들거나 부분 또는 다중 컬럼 인덱스 같은 대체인덱스를 만든다면 오버헤드를 피할 수 있다.

- **on_delete**

  - models.CASCADE : foreignkeyfield가 바라보는값이 삭제되면 이 모델 인스턴스도 삭제되는 구조

  - models.PROTECT : foreignkeyfield가 바라보는값이 삭제되면 이 모델 인스턴스는 삭제가 안되는 구조

  - models.NULL : foreignkeyfield가 바라보는값이 삭제되면 이 모델 인스턴스는 NULL로 변환( NULL=True일때만 가능함)

  - models.SET_DEFAULT : foreignkeyfield가 바라보는값이 삭제되면 이 모델 인스턴스는 default로 만든다. (default값이 있을 때문 가능)

- **related_name**

  - 관련된 객체에서 이 객체로 돌아올 관계에 사용될 이름이다. 대상모델의 역필터이름에 사용될 이름을 정의하는 것이다.  
    추상 모델 관계를 정의할 때는 related_name을 반드시 설정해야 한다.  
    django가 뒤에서 관계를 생성하는 것을 원하지 않는 경우 related_name을 '+'또는 '+'로 끝나도록 설정한다. 역방향 관계를 갖지 않도록 보장한다.

- **to_field**
  관계가 있는 관련 객체의 필드, 기본적으로 django는 관련 객체의 기본키를 사용한다. 다른 필드를 참조하고 싶다면 그 필드는 unique=True여야 한다.

- **db_constraint**
  제약조건에 대한 제어여부 설정. 기본값은 True이고 대부분 기본값 사용한다. False는 데이터 무결성에 매우 좋지 않지만 다음 경우는 사용한다
  - 유효하지 않는 기존 데이터가 있다.
  - 데이터베이스가 샤딩되어있다.
  - False 설정한다면 존재하지 않는 관련된 객체에 접근할 때 DoesNotExist 예외가 발생한다.
